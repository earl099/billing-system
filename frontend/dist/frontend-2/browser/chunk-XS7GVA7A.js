import{a as re}from"./chunk-ZST6NYC3.js";import{a as A,c as ee,d as te,f as V,g as ie}from"./chunk-MPX5GK3F.js";import{$b as _,F as u,Ha as F,Ua as i,Xb as $,Y as s,Yb as C,Zb as y,_b as c,aa as g,ac as x,bc as E,cc as I,da as h,dc as M,ec as w,fb as Y,fc as N,gb as v,ha as b,hc as U,ic as T,jc as D,kc as L,lc as k,nc as R,oc as q,pa as H,pb as S,pc as P,qa as X,qb as Z,qc as f,rc as G,ua as d,va as a,wa as t,xa as p,ya as Q,za as W}from"./chunk-WCTJA6V4.js";var B=class r{constructor(o){this.router=o}authService=u(C);ngOnInit(){this.authService.isAuthenticated()&&this.router.navigate(["/dashboard"])}static \u0275fac=function(e){return new(e||r)(g(S))};static \u0275cmp=h({type:r,selectors:[["app-home"]],decls:2,vars:0,template:function(e,n){e&1&&(Q(0,"p"),i(1,"home works!"),W())},dependencies:[v],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0})};function de(r,o){r&1&&(a(0,"mat-error"),i(1," Required Field "),t())}function ce(r,o){r&1&&(a(0,"mat-error"),i(1," Required Field "),t())}var j=class r{constructor(o){this.fb=o;this.signInForm=this.fb.group({identifier:["",[c.required]],password:["",[c.required]]})}signInForm;authService=u(C);logsService=u(P);router=u(S);onLogin(o){this.authService.login(o.value).subscribe(e=>{if(e){f.success(e.message==null?"":e.message),e.user?.username?this.authService.setToken("user",e.user.username):this.authService.setToken("user",e.user.email),this.authService.setToken("role",e.user.role.toString()),this.authService.setToken("accessToken",e.accessToken);let n=Number(this.authService.getToken("expirationDuration"));setTimeout(()=>{localStorage.clear(),this.router.navigate(["/dashboard"])},n*1e3),this.router.navigate(["/login"]);let m={operation:"Logged in Account",user:this.authService.getToken("user")??""};this.logsService.addLog(m).subscribe()}else f.error("Invalid credentials."),localStorage.clear(),this.signInForm.get("identifier")?.reset(""),this.signInForm.get("password")?.reset("")})}static \u0275fac=function(e){return new(e||r)(g(w))};static \u0275cmp=h({type:r,selectors:[["app-login"]],decls:21,vars:4,consts:[[1,"min-h-[100%]","flex","flex-col","items-center","justify-center","bg-gray-100"],[1,"w-full","max-w-md","p-6","shadow-lg"],[1,"text-2xl","font-semibold","text-center","text-gray-700","mb-6"],[3,"formGroup"],["appearance","fill",1,"w-full","mb-4"],["matInput","","formControlName","identifier","type","text","placeholder","Please enter username or email"],["matInput","","type","password","formControlName","password","placeholder","Enter your password"],[1,"mt-6"],["mat-raised-button","","color","primary","type","submit",1,"w-full","py-2",3,"click","disabled"]],template:function(e,n){if(e&1&&(a(0,"div",0)(1,"mat-card",1)(2,"mat-card-content")(3,"h2",2),i(4," Sign In "),t(),a(5,"form",3)(6,"mat-form-field",4)(7,"mat-label"),i(8,"Email/Username"),t(),p(9,"input",5),H(10,de,2,0,"mat-error"),t(),a(11,"mat-form-field",4)(12,"mat-label"),i(13,"Password"),t(),p(14,"input",6),H(15,ce,2,0,"mat-error"),t(),a(16,"div",7),p(17,"ngx-sonner-toaster"),a(18,"button",8),F("click",function(){return n.onLogin(n.signInForm)}),i(19," Sign In "),t()()()(),p(20,"mat-card-actions"),t()()),e&2){let m,l;s(5),d("formGroup",n.signInForm),s(5),X((m=n.signInForm.get("identifier"))!=null&&m.hasError("required")?10:-1),s(5),X((l=n.signInForm.get("password"))!=null&&l.hasError("required")?15:-1),s(3),d("disabled",n.signInForm.invalid)}},dependencies:[v,N,E,y,_,x,I,M,q,R,k,D,L,T,U,V,A,te,ee,G],encapsulation:2,changeDetection:0})};function ae(){return r=>{let o=r.get("password"),e=r.get("confirmPass");return o&&e&&o.value!==e.value?{passwordsDoNotMatch:!0}:null}}function fe(r,o){r&1&&(a(0,"mat-error"),i(1," Required Field "),t())}function ge(r,o){r&1&&(a(0,"mat-error"),i(1," Input must be an email "),t())}function he(r,o){r&1&&(a(0,"mat-error"),i(1," Required Field "),t())}function ve(r,o){r&1&&(a(0,"mat-error"),i(1," Required Field "),t())}function Se(r,o){r&1&&(a(0,"mat-error"),i(1," Required Field "),t())}var O=class r{constructor(o,e){this.fb=o;this.router=e;this.signUpForm=this.fb.group({username:["",c.required],email:["",[c.required,c.email]],password:["",c.required],confirmPass:["",c.required],userType:[""]},{validators:ae()})}signUpForm;users;authService=u(C);userService=u($);logsService=u(P);ngOnInit(){}onSubmit(){this.signUpForm.valid?this.userService.getUsers().subscribe(o=>{let e=o,n;e==null?(this.signUpForm.get("userType")?.setValue("Admin"),n={operation:"Add Admin Account",user:this.signUpForm.get("username")?.value},this.logsService.addLog(n).subscribe(m=>{m&&this.authService.signup(this.signUpForm.value).subscribe(l=>{l?(f.success(l.message),this.router.navigate(["/login"])):f.error("Error signing up")})})):(this.signUpForm.get("userType")?.setValue("User"),n={operation:"Add User Account",user:this.signUpForm.get("username")?.value},this.logsService.addLog(n).subscribe(m=>{m&&this.authService.signup(this.signUpForm.value).subscribe(l=>{l?(f.success(l.message),this.router.navigate(["/login"])):f.error("Server error")})}))}):(f.error("Passwords do not match."),this.signUpForm.get("username")?.setValue(""),this.signUpForm.get("email")?.setValue(""),this.signUpForm.get("password")?.setValue(""),this.signUpForm.get("confirmPass")?.setValue(""))}static \u0275fac=function(e){return new(e||r)(g(w),g(S))};static \u0275cmp=h({type:r,selectors:[["app-signup"]],decls:33,vars:6,consts:[[1,"min-h-screen","flex","flex-col","items-center","justify-center","bg-gray-100"],[1,"shadow-lg","w-full","max-w-md","p-6"],[1,"text-2xl","font-semibold","text-center","text-gray-700","mb-6"],[3,"formGroup"],["appearance","fill",1,"w-full","mb-4"],["matInput","","type","text","formControlName","email","placeholder","Enter your email"],[4,"ngIf"],["matInput","","type","text","formControlName","username","placeholder","Enter your username"],["matInput","","type","password","formControlName","password","placeholder","Enter your password"],["matInput","","type","password","formControlName","confirmPass","placeholder","Confirm your password"],["mat-raised-button","","color","primary","type","submit",1,"w-full","py-2",3,"click"],[1,"text-center","text-sm","text-gray-600","mt-4"],["routerLink","/login",1,"text-blue-600","hover:underline"]],template:function(e,n){if(e&1&&(a(0,"div",0)(1,"mat-card",1)(2,"h2",2),i(3," Sign Up "),t(),a(4,"form",3)(5,"mat-form-field",4)(6,"mat-label"),i(7,"Email"),t(),p(8,"input",5),b(9,fe,2,0,"mat-error",6)(10,ge,2,0,"mat-error",6),t(),a(11,"mat-form-field",4)(12,"mat-label"),i(13,"Username"),t(),p(14,"input",7),b(15,he,2,0,"mat-error",6),t(),a(16,"mat-form-field",4)(17,"mat-label"),i(18,"Password"),t(),p(19,"input",8),b(20,ve,2,0,"mat-error",6),t(),a(21,"mat-form-field",4)(22,"mat-label"),i(23,"Confirm Password"),t(),p(24,"input",9),b(25,Se,2,0,"mat-error",6),t(),p(26,"ngx-sonner-toaster"),a(27,"button",10),F("click",function(){return n.onSubmit()}),i(28,"Sign Up"),t()(),a(29,"p",11),i(30," Already have an account? "),a(31,"a",12),i(32,"Sign In"),t()()()()),e&2){let m,l,z,J,K;s(4),d("formGroup",n.signUpForm),s(5),d("ngIf",(m=n.signUpForm.get("email"))==null?null:m.hasError("required")),s(),d("ngIf",(l=n.signUpForm.get("email"))==null?null:l.hasError("email")),s(5),d("ngIf",(z=n.signUpForm.get("username"))==null?null:z.hasError("required")),s(5),d("ngIf",(J=n.signUpForm.get("password"))==null?null:J.hasError("required")),s(5),d("ngIf",(K=n.signUpForm.get("confirmPass"))==null?null:K.hasError("required"))}},dependencies:[v,Y,Z,N,E,y,_,x,I,M,q,R,k,D,L,T,U,V,A,G],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0})};var ct=[{path:"home",component:B},{path:"login",component:j},{path:"signup",component:O},{path:"dashboard",component:re,canActivate:[ie]}];export{ct as INDEX_ROUTES};
