import{a as k,b as q}from"./chunk-CZB52U7V.js";import{a as nt,b as lt,c as O,d as At,e as U,f as Lt,g as Ft,h as Rt,i as It,j as zt,k as Ht,l as Ot,m as Ut,n as Vt,o as Gt,p as Pt,q as Nt,r as $t,s as kt}from"./chunk-2JJRFBDY.js";import{a as qt,b as jt}from"./chunk-AOPF5MQS.js";import{a as wt,b as Ct,c as xt,e as bt,f as Mt,g as Et}from"./chunk-MPX5GK3F.js";import{$b as B,Ba as x,C as ut,Ca as b,Ea as P,F as m,Gb as _t,Ha as f,I as _,J as y,Ja as w,Kc as et,Lc as Dt,Mc as it,Na as N,Nb as $,Nc as ot,Oa as T,Oc as rt,Pa as D,Pc as at,Qa as ft,Ua as n,Wa as M,Xb as A,Y as s,Ya as ht,Zb as j,_b as u,aa as G,ac as Q,bc as Y,cc as W,da as C,dc as Z,ea as gt,ec as J,fc as K,gb as E,gc as yt,ha as g,hc as X,ic as L,jc as F,kc as St,lc as R,mc as vt,nc as I,oc as z,pa as S,pc as tt,qa as v,qc as H,rc as Tt,ua as p,va as r,wa as o,xa as d}from"./chunk-WCTJA6V4.js";var st=(()=>{class i{static \u0275fac=function(a){return new(a||i)};static \u0275mod=gt({type:i});static \u0275inj=ut({imports:[k,$,k,$]})}return i})();var Yt=["class","list"],Wt=()=>[5,10,15];function Zt(i,e){i&1&&(r(0,"th",17),n(1,"Username"),o())}function Jt(i,e){if(i&1&&(r(0,"td",18),n(1),o()),i&2){let t=e.$implicit;s(),M(" ",t.username," ")}}function Kt(i,e){i&1&&(r(0,"th",17),n(1,"Email"),o())}function Xt(i,e){if(i&1&&(r(0,"td",18),n(1),o()),i&2){let t=e.$implicit;s(),M(" ",t.email," ")}}function te(i,e){i&1&&(r(0,"th",17),n(1,"User Type"),o())}function ee(i,e){if(i&1&&(r(0,"td",18),n(1),o()),i&2){let t=e.$implicit;s(),M(" ",t.role," ")}}function ie(i,e){i&1&&(r(0,"th",17),n(1,"Actions"),o())}function oe(i,e){if(i&1){let t=P();r(0,"td",18)(1,"div",19)(2,"button",20),f("click",function(){let l=_(t).$implicit,c=w();return y(c.openViewUserDialog(l._id))}),r(3,"mat-icon"),n(4,"visibility"),o()(),r(5,"button",21),f("click",function(){let l=_(t).$implicit,c=w();return y(c.openUpdateUserDialog(l._id))}),r(6,"mat-icon"),n(7,"edit"),o()(),r(8,"button",22),f("click",function(){let l=_(t).$implicit,c=w();return y(c.delUser(l._id))}),r(9,"mat-icon"),n(10,"delete"),o()()()()}if(i&2){let t,a=e.$implicit,l=w();s(8),p("disabled",a.username==((t=l.userService.user())==null?null:t.username))}}function re(i,e){i&1&&d(0,"tr",23)}function ae(i,e){i&1&&d(0,"tr",24)}function ne(i,e){if(i&1&&(r(0,"tr",24)(1,"td"),n(2),o()()),i&2){w();let t=ft(10);s(2),M('No data matching the filter "',t.value,'"')}}function le(i,e){i&1&&(r(0,"mat-error"),n(1," Required Field "),o())}function se(i,e){i&1&&(r(0,"mat-error"),n(1," Required Field "),o())}function de(i,e){i&1&&(r(0,"mat-error"),n(1," Required Field "),o())}function me(i,e){i&1&&(r(0,"mat-error"),n(1," Required Field "),o())}function ce(i,e){i&1&&(r(0,"mat-error"),n(1," Required Field "),o())}var V=class i{dataSource;users=[];columns=["username","email","role","actions"];paginator;sort;logsService=m(tt);userService=m(A);dialog=m(Dt);_liveAnnouncer=m(_t);ngOnInit(){this.getUsers()}getUsers(){this.userService.getUsers().subscribe(e=>{if(e){let t=e.users;for(let a=0;a<t.length;a++)this.users.push(t[a]);this.dataSource=new kt(this.users),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}})}applyFilter(e){let t=e.target.value;this.dataSource.filter=t.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}announceSortChange(e){e.direction?H.info(`Sorted in ${e.direction} order`):H.info("Sorting cleared")}openUpdateUserDialog(e){this.dialog.open(dt,{data:{_id:e}}).afterClosed().subscribe(()=>{this.dataSource.data.splice(0,this.dataSource.data.length),this.getUsers()})}openViewUserDialog(e){this.dialog.open(mt,{data:{_id:e}}).afterClosed().subscribe(()=>{this.dataSource.data.splice(0,this.dataSource.data.length),this.getUsers()})}delUser(e){if(confirm("Are you sure you want to delete this data?")){let t={operation:"Deleted User",user:this.userService.user()?.username??""};this.userService.deleteUser(e).subscribe(a=>{a&&this.logsService.addLog(t).subscribe(l=>{l&&(H.success("Account deleted successfully."),this.dataSource.data.splice(0,this.dataSource.data.length),this.getUsers())})})}}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=C({type:i,selectors:[["app-account",8,"list"]],viewQuery:function(t,a){if(t&1&&(N(O,5),N(U,5)),t&2){let l;T(l=D())&&(a.paginator=l.first),T(l=D())&&(a.sort=l.first)}},attrs:Yt,decls:29,vars:5,consts:[["input",""],[1,"min-h-screen","flex","flex-col","items-center","justify-center","bg-gray-100"],[1,"shadow-lg","w-full","max-w-3xl","p-6"],[1,"text-2xl","font-semibold","text-center","text-gray-700","mb-6"],["appearance","fill",1,"w-full","mb-4"],["matInput","","placeholder","Search a user","autocomplete","off",3,"keyup"],["mat-table","","matSort","",3,"matSortChange","dataSource"],["matColumnDef","username"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","email"],["matColumnDef","role"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-row","",4,"matNoDataRow"],[3,"pageSizeOptions"],["mat-header-cell",""],["mat-cell",""],[1,"flex","justify-end","gap-0.5"],["mat-icon-button","","matTooltip","View User",3,"click"],["mat-icon-button","","matTooltip","Edit Details",3,"click"],["mat-icon-button","","matTooltip","Delete User",1,"hover:!text-red-600",3,"click","disabled"],["mat-header-row",""],["mat-row",""]],template:function(t,a){if(t&1){let l=P();r(0,"div",1)(1,"mat-card",2)(2,"mat-card-header",3)(3,"mat-card-title"),n(4," Accounts "),o()(),r(5,"mat-card-content")(6,"mat-form-field",4)(7,"mat-label"),n(8,"Search"),o(),r(9,"input",5,0),f("keyup",function(h){return _(l),y(a.applyFilter(h))}),o()(),r(11,"table",6),f("matSortChange",function(h){return _(l),y(a.announceSortChange(h))}),x(12,7),g(13,Zt,2,0,"th",8)(14,Jt,2,1,"td",9),b(),x(15,10),g(16,Kt,2,0,"th",8)(17,Xt,2,1,"td",9),b(),x(18,11),g(19,te,2,0,"th",8)(20,ee,2,1,"td",9),b(),x(21,12),g(22,ie,2,0,"th",8),d(23,"ngx-sonner-toaster"),g(24,oe,11,1,"td",9),b(),g(25,re,1,0,"tr",13)(26,ae,1,0,"tr",14)(27,ne,3,1,"tr",15),o(),d(28,"mat-paginator",16),o()()()}t&2&&(s(11),p("dataSource",a.dataSource),s(14),p("matHeaderRowDef",a.columns),s(),p("matRowDefColumns",a.columns),s(2),p("pageSizeOptions",ht(4,Wt)))},dependencies:[E,vt,R,F,z,I,Mt,wt,xt,bt,Ct,L,yt,$t,Ft,It,Ut,zt,Rt,Vt,Ht,Ot,Gt,Pt,Nt,At,O,Lt,U,jt,qt,lt,nt,Tt],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0})},dt=class i{constructor(e){this.fb=e;this.editDetailForm=this.fb.group({username:["",u.required],email:["",u.required],password:["",u.required],role:["",u.required],handledClients:[[]]})}editDetailForm;data=m(et);userService=m(A);logsService=m(tt);toastr=m(q);userId=this.data._id;ngOnInit(){this.getUser()}getUser(){this.userService.getUser(this.userId).subscribe(e=>{if(e){let t=e.user;this.editDetailForm.get("username")?.setValue(t.username),this.editDetailForm.get("email")?.setValue(t.email),this.editDetailForm.get("password")?.setValue(t.password),this.editDetailForm.get("role")?.setValue(t.role),this.editDetailForm.get("handledClients")?.setValue(t.handledClients)}})}onEditDetails(e){if(confirm("Are you sure you want to edit the details?")){let t={username:e.value.username,email:e.value.email,password:e.value.password,role:e.value.role,handledClients:e.value.handledClients};this.userService.updateUser(this.userId,t).subscribe(a=>{if(a){let l={operation:"Updated User Data",user:this.userService.user()?.username??""};this.logsService.addLog(l).subscribe(),this.toastr.success("Edited Data Successfully.")}})}}static \u0275fac=function(t){return new(t||i)(G(J))};static \u0275cmp=C({type:i,selectors:[["edit-details-dialog"]],decls:34,vars:7,consts:[["mat-dialog-title",""],[3,"formGroup"],[1,"w-full","mb-4"],["matInput","","type","text","formControlName","username"],["matInput","","type","text","formControlName","email"],["matInput","","type","password","formControlName","password"],["matInput","","type","text","formControlName","handledClients"],["matInput","","type","text","formControlName","role","readonly",""],[1,"mt-6"],["mat-raised-button","","mat-dialog-close","","color","primary","type","submit",1,"w-full","py-2",3,"click","disabled"],["mat-raised-button","","mat-dialog-close","","color","primary",1,"w-full","py-2","mt-3"]],template:function(t,a){if(t&1&&(r(0,"h2",0),n(1,"Edit Details"),o(),r(2,"mat-dialog-content")(3,"form",1)(4,"mat-form-field",2)(5,"mat-label"),n(6,"Username"),o(),d(7,"input",3),S(8,le,2,0,"mat-error"),o(),r(9,"mat-form-field",2)(10,"mat-label"),n(11,"Email"),o(),d(12,"input",4),S(13,se,2,0,"mat-error"),o(),r(14,"mat-form-field",2)(15,"mat-label"),n(16,"Password"),o(),d(17,"input",5),S(18,de,2,0,"mat-error"),o(),r(19,"mat-form-field",2)(20,"mat-label"),n(21,"Handled Clients"),o(),d(22,"input",6),S(23,me,2,0,"mat-error"),o(),r(24,"mat-form-field",2)(25,"mat-label"),n(26,"Role"),o(),d(27,"input",7),S(28,ce,2,0,"mat-error"),o(),r(29,"div",8)(30,"button",9),f("click",function(){return a.onEditDetails(a.editDetailForm)}),n(31," Edit Details "),o(),r(32,"button",10),n(33," Close Dialog "),o()()()()),t&2){let l,c,h,ct,pt;s(3),p("formGroup",a.editDetailForm),s(5),v((l=a.editDetailForm.get("username"))!=null&&l.hasError("required")?8:-1),s(5),v((c=a.editDetailForm.get("email"))!=null&&c.hasError("required")?13:-1),s(5),v((h=a.editDetailForm.get("password"))!=null&&h.hasError("required")?18:-1),s(5),v((ct=a.editDetailForm.get("handledClients"))!=null&&ct.hasError("required")?23:-1),s(5),v((pt=a.editDetailForm.get("role"))!=null&&pt.hasError("required")?28:-1),s(2),p("disabled",a.editDetailForm.invalid)}},dependencies:[E,z,I,R,F,St,L,X,at,it,ot,rt,st,K,Y,j,B,Q,W,Z],styles:["[_nghost-%COMP%]{display:block}"]})},mt=class i{constructor(e){this.fb=e;this.viewAccountForm=this.fb.group({username:["",u.required],email:["",u.required],password:["",u.required],role:[""]})}viewAccountForm;data=m(et);userService=m(A);toastr=m(q);userId=this.data._id;ngOnInit(){this.getUser()}getUser(){this.userService.getUser(this.userId).subscribe(e=>{if(e){let t=e.user;console.log(t),this.viewAccountForm.get("username")?.setValue(t.username),this.viewAccountForm.get("email")?.setValue(t.email),this.viewAccountForm.get("password")?.setValue(t.password),this.viewAccountForm.get("role")?.setValue(t.role)}})}static \u0275fac=function(t){return new(t||i)(G(J))};static \u0275cmp=C({type:i,selectors:[["view-user-dialog"]],decls:23,vars:1,consts:[["mat-dialog-title",""],[3,"formGroup"],[1,"w-full","mb-4"],["matInput","","type","text","formControlName","username","readonly",""],["matInput","","type","text","formControlName","email","readonly",""],["matInput","","type","password","formControlName","password","readonly",""],["matInput","","type","text","formControlName","role","readonly",""],[1,"mt-6"],["mat-raised-button","","mat-dialog-close","","color","primary",1,"w-full","py-2","mt-3"]],template:function(t,a){t&1&&(r(0,"h2",0),n(1,"View User"),o(),r(2,"mat-dialog-content")(3,"form",1)(4,"mat-form-field",2)(5,"mat-label"),n(6,"Username"),o(),d(7,"input",3),o(),r(8,"mat-form-field",2)(9,"mat-label"),n(10,"Email"),o(),d(11,"input",4),o(),r(12,"mat-form-field",2)(13,"mat-label"),n(14,"Password"),o(),d(15,"input",5),o(),r(16,"mat-form-field",2)(17,"mat-label"),n(18,"Role"),o(),d(19,"input",6),o(),r(20,"div",7)(21,"button",8),n(22," Close Dialog "),o()()()()),t&2&&(s(3),p("formGroup",a.viewAccountForm))},dependencies:[E,z,I,R,F,L,X,at,it,ot,rt,st,K,Y,j,B,Q,W,Z],styles:["[_nghost-%COMP%]{display:block}"]})};var wi=[{path:"accounts",component:V,canActivate:[Et]}];export{wi as ACCOUNT_ROUTES};
