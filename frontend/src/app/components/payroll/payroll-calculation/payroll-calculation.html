<div class="payroll-calculation-container">
  <mat-card>
    <mat-toolbar color="primary">
      <span>Payroll Calculation</span>
    </mat-toolbar>
    <mat-card-content>
      <p>Upload a CSV file with timekeeping data and then click 'Calculate Payroll' to see the computed salaries.</p>

      <input type="file" (change)="onFileSelected($event)" accept=".csv">

      <div *ngIf="uploadedTimekeepData.length > 0" class="mt-4">
        <h3>Uploaded Timekeeping Data Preview</h3>
        <table mat-table [dataSource]="uploadedTimekeepData" class="mat-elevation-z8">
          <!-- Employee ID Column -->
          <ng-container matColumnDef="employeeId">
            <th mat-header-cell *matHeaderCellDef> Employee ID </th>
            <td mat-cell *matCellDef="let element"> {{element.employeeId}} </td>
          </ng-container>
          <!-- Date Column -->
          <ng-container matColumnDef="date">
            <th mat-header-cell *matHeaderCellDef> Date </th>
            <td mat-cell *matCellDef="let element"> {{element.date}} </td>
          </ng-container>
          <!-- Hours Worked Column -->
          <ng-container matColumnDef="hoursWorked">
            <th mat-header-cell *matHeaderCellDef> Hours Worked </th>
            <td mat-cell *matCellDef="let element"> {{element.hoursWorked}} </td>
          </ng-container>
          <!-- Shift Type Column -->
          <ng-container matColumnDef="shiftType">
            <th mat-header-cell *matHeaderCellDef> Shift Type </th>
            <td mat-cell *matCellDef="let element"> {{element.shiftType}} </td>
          </ng-container>
          <tr mat-header-row *matHeaderRowDef="timekeepDisplayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: timekeepDisplayedColumns;"></tr>
        </table>
      </div>

      <button mat-raised-button color="accent" (click)="calculatePayroll()" [disabled]="uploadedTimekeepData.length === 0" class="mt-4">
        Calculate Payroll
      </button>

      <div *ngIf="calculatedPayroll.length > 0" class="mt-4">
        <h3>Calculated Payroll Entries</h3>
        <table mat-table [dataSource]="calculatedPayroll" class="mat-elevation-z8">

          <!-- Employee Name Column -->
          <ng-container matColumnDef="employeeName">
            <th mat-header-cell *matHeaderCellDef> Employee Name </th>
            <td mat-cell *matCellDef="let element"> {{element.employeeName}} </td>
          </ng-container>

          <!-- Position Column -->
          <ng-container matColumnDef="position">
            <th mat-header-cell *matHeaderCellDef> Position </th>
            <td mat-cell *matCellDef="let element"> {{element.position}} </td>
          </ng-container>

          <!-- Department Column -->
          <ng-container matColumnDef="department">
            <th mat-header-cell *matHeaderCellDef> Department </th>
            <td mat-cell *matCellDef="let element"> {{element.department}} </td>
          </ng-container>

          <!-- Total Hours Column -->
          <ng-container matColumnDef="totalHours">
            <th mat-header-cell *matHeaderCellDef> Total Hours </th>
            <td mat-cell *matCellDef="let element"> {{element.totalHours}} </td>
          </ng-container>

          <!-- Rate Per Hour Column -->
          <ng-container matColumnDef="ratePerHour">
            <th mat-header-cell *matHeaderCellDef> Rate/Hour </th>
            <td mat-cell *matCellDef="let element"> {{element.ratePerHour | currency}} </td>
          </ng-container>

          <!-- Gross Salary Column -->
          <ng-container matColumnDef="grossSalary">
            <th mat-header-cell *matHeaderCellDef> Gross Salary </th>
            <td mat-cell *matCellDef="let element"> {{element.grossSalary | currency}} </td>
          </ng-container>

          <!-- Shift Type Column -->
          <ng-container matColumnDef="shiftType">
            <th mat-header-cell *matHeaderCellDef> Shift Type </th>
            <td mat-cell *matCellDef="let element"> {{element.shiftType}} </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="payrollDisplayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: payrollDisplayedColumns;"></tr>
        </table>
      </div>
    </mat-card-content>
  </mat-card>
</div>